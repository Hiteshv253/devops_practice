---
- name: Install Apache on Ubuntu
  hosts: all
  become: yes

  tasks:
- name: Install nginx 
  ansible.builtin.apt:
    name: nginx
    state: present
    update_cache: yes

- name: Stop nginx if running
  ansible.builtin.service:
    name: nginx
    state: stopped
    enabled: no

- name: Ensure apache2 is installed
  ansible.builtin.apt:
    name: apache2
    state: present

- name: Ensure apache2 is running and enabled
  ansible.builtin.service:
    name: apache2
    state: started
    enabled: yes

- name: Install Apache
  ansible.builtin.apt:
    name: apache2
    state: present
    update_cache: yes

- name: Start and enable Apache
  ansible.builtin.service:
    name: apache2
    state: started
    enabled: yes

- name: install mysql client to node server
  ansible.builtin.apt:
    name: mysql
    state: present

- name: install phpmyadmin
  ansible.builtin.apt:
    name: phpmyadmin
    state: present

- name: Create directory
  file:
    path: /tmp/my_directory
    state: directory

- name: Create file
  command: "touch /tmp/my_directory/my_file.txt"

- name: Set UFW default policy to allow
  community.general.ufw:
    state: enabled
    policy: allow
    direction: incoming

- name: Enable UFW
  community.general.ufw:
    state: enabled